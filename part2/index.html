<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css">
    <title>Cloudinary Demo</title>
</head>

<body>

    <div class="main">
        <div class="main-photo">
            <img id="main-img" src="" width="500px" />
        </div>
        <div class="btn-group">
            <div class="btn" id="text-btn">Text overlay</div>
            <div class="btn" id="crop-btn">Crop to square </div>
            <div class="btn" id="cartoon-btn">Cartoonify <br>&nbsp;</br></div>
            <div class="btn" id="genremove-btn">Generative Remove</div>
            <div class="btn" id="reset-btn">Reset</div>
        </div>
    </div>
    <script type="module">
        // 1. Import the Cloudinary class and the cartoonify effect
        import { Cloudinary } from "https://cdn.skypack.dev/@cloudinary/url-gen";
        import { cartoonify } from "https://cdn.skypack.dev/@cloudinary/url-gen/actions/effect";
        import { source } from "https://cdn.skypack.dev/@cloudinary/url-gen/actions/overlay";
        import { text } from "https://cdn.skypack.dev/@cloudinary/url-gen/qualifiers/source";
        import { TextStyle } from "https://cdn.skypack.dev/@cloudinary/url-gen/qualifiers/textStyle";
        import { fill } from "https://cdn.skypack.dev/@cloudinary/url-gen/actions/resize";
        import { autoGravity } from "https://cdn.skypack.dev/@cloudinary/url-gen/qualifiers/gravity";
        import { generativeRemove } from "https://cdn.skypack.dev/@cloudinary/url-gen/actions/effect";

        const imageElement = document.getElementById("main-img");

        // 2. Configure your Cloudinary instance (replace "demo" with your cloud name)
        const cld = new Cloudinary({
            cloud: { cloudName: "demo" }
        });

        // 3. Reference the original image (replace "sample" with your image public ID)
        let myImage = cld.image("sample");

        // 3.1 updta the image
        function updateImage(imageElement, cloudinaryImage) {
            imageElement.src = cloudinaryImage.toURL();
        }

        updateImage(imageElement, myImage);

        // 4. Add event listener to apply cartoonify on button click
        document.getElementById("cartoon-btn").addEventListener("click", () => {
            myImage.effect(cartoonify());
            updateImage(imageElement, myImage);
        });

        // 5. Text overlay button
        document.getElementById("text-btn").addEventListener("click", () => {
            myImage.overlay(
                source(
                    text("Overlay Text", new TextStyle("Arial", 50)).textColor("white")
                )
            );
            updateImage(imageElement, myImage);
        });

        // 6. Crop to square button
        document.getElementById("crop-btn").addEventListener("click", () => {
            myImage.resize(
                fill()
                    .width(333)
                    .aspectRatio("1:1")
                    .gravity(autoGravity())
            );
            updateImage(imageElement, myImage);
        });

        // 7. Bonus 1: Generative Remove button
        document.getElementById("genremove-btn").addEventListener("click", () => {
            myImage.effect(
                generativeRemove().prompt("bee")
            );
            updateImage(imageElement, myImage);
        });

        // 8. Reset button to original image
        document.getElementById("reset-btn").addEventListener("click", () => {
            myImage = cld.image("sample");
            updateImage(imageElement, myImage);
        });
    </script>

</body>

</html>